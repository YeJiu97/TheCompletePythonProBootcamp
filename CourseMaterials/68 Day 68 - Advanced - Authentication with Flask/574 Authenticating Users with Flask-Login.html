<html><head><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/image.min.css"></head><body><div class="container"><div class="row"><div class="col-md-10 col-md-offset-1 ui image"><p class="lead"><p>At the moment, if you simply navigate to <code>/secrets</code> you can see the secret page and the download link. There are no authentication barriers. How can we make sure that only registered/logged in users can see that page and download the file?</p><p>We'll need to secure certain routes in our server and make them only accessible if a user is authenticated.</p><p>To do this, most Flask developers will use the Flask_Login package.</p><p>HARD&nbsp;CHALLENGE:</p><p>Use the <a href="https://flask-login.readthedocs.io/en/latest/" rel="noopener noreferrer" target="_blank">Flask_Login documentation</a> to implement the <code>/login</code> route. The <code>/secrets</code> route should be secured so that it requires the user to be logged in. </p><p>This is what you're aiming for:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-18_16-14-30-8561389d38516fa530d2c4a2fc4e01d8.gif"></figure><p>HINT 1: <a href="https://flask-login.readthedocs.io/en/latest/#configuring-your-application" rel="noopener noreferrer" target="_blank">You will need to configure your Flask app to use Flask_Login</a>.</p><p>HINT 2: <a href="https://flask-login.readthedocs.io/en/latest/#how-it-works" rel="noopener noreferrer" target="_blank">You will need to create a user_loader function</a>.</p><p>HINT 3: Make sure you <a href="https://flask-login.readthedocs.io/en/latest/#your-user-class" rel="noopener noreferrer" target="_blank">implement the UserMixin</a> in your User class.</p><p>Note: A Mixin is simply a way to provide multiple inheritance to Python. This is how you add a Mixin:</p><p><code>class MyClass(MixinClassB, MixinClassA, BaseClass):</code> </p><p><a href="https://www.thedigitalcatonline.com/blog/2020/03/27/mixin-classes-in-python/" rel="noopener noreferrer" target="_blank">Further Reading on Mixins</a></p><p>HINT 4: <a href="https://werkzeug.palletsprojects.com/en/1.0.x/utils/#werkzeug.security.check_password_hash" rel="noopener noreferrer" target="_blank">You can check the user's password using the check_password_hash function</a>.</p><p>HINT 5: You need to find the user by the email they entered in the login form. </p><p>HINT 6: If the user has successfully logged in or registered, you need to use the login_user() function to authenticate them.</p><p>HINT 7: Both the /secrets and /download route need to be <a href="https://flask-login.readthedocs.io/en/latest/#flask_login.login_required" rel="noopener noreferrer" target="_blank">secured</a> so that only authenticated users can access them.</p><p><a href="https://gist.github.com/angelabauer/f53574e00338a08e989c3c983506a8ba" rel="noopener noreferrer" target="_blank">SOLUTION</a></p></p></div></div></div></body></html>