<html><head><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/image.min.css"></head><body><div class="container"><div class="row"><div class="col-md-10 col-md-offset-1 ui image"><p class="lead"><h4>Read and Write Data to your Google Sheet</h4><p>The goal for this step is to read and write some data to the Google Sheet. This way you can check if Sheety is working correctly before connecting the Kiwi Partners Flight Search API&nbsp;and getting the actual IATA codes for each city to the Google Sheet.</p><figure><img height="401" src="https://img-c.udemycdn.com/redactor/raw/2020-07-30_10-37-21-cf4f10525123b8fad6e1aa08d1e5a7cd.png" width="624"></figure><p>1. Go to the link for the <a href="https://docs.google.com/spreadsheets/d/1YMK-kYDYwuiGZoawQy7zyDjEIU9u8oggCV4H2M9j7os/edit?usp=sharing" rel="noopener noreferrer" target="_blank">starting Google Sheet and make your own copy of it. </a>Then create a new project on Sheety to work with your copy of the Google sheet. </p><figure><img height="339" src="https://img-c.udemycdn.com/redactor/raw/2020-07-30_10-39-17-3d2c648aeeffe0f66d6a5eea685c0425.png" width="757"></figure><p><br></p><h4>Make requests using the Sheety API</h4><p>2. Now use the <a href="https://sheety.co/" rel="noopener noreferrer" target="_blank">Sheety API</a> to GET all the data in that sheet and print it out. You should see something like this:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-07-30_10-50-25-324e90bf116fdaaac999cbeed38c9770.png"></figure><p>3. Try importing pretty print with the line <code>from pprint import pprint</code> and printing the data out again using <code>pprint()</code> to see it formatted.</p><p>4. Pass everything stored in the <code>"prices"</code> key back to the <strong>main.py </strong>file and store it in a variable called <code>sheet_data</code>, so that you can print the <code>sheet_data</code> from main.py</p><p>e.g.</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-07-30_11-11-57-8a87e9f699f8813b7fba53af96ffa10e.png"></figure><p>5. In main.py check if <code>sheet_data</code> contains any values for the "iataCode" key. If not, then the IATA Codes column is empty in the Google Sheet. In this case, pass each city name in <code>sheet_data</code> one-by-one to the FlightSearch class. For now, the FlightSearch class can respond with "TESTING" instead of a real IATA code. You should use the response from the FlightSearch class to update the <code>sheet_data</code> dictionary.</p><p><br></p><p>Print the updated <code>sheet_data</code> dictionary and you should see:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2021-02-01_12-02-37-14e01d4c95ee0b5b7a958eba0673e7f2.png"></figure><p>6. In the DataManager Class make a PUT request&nbsp;and use the row <code>id</code>&nbsp; from <code>sheet_data</code> to update the Google Sheet with the IATA codes. (Do this using code). HINT: Remember to check the checkbox to allow PUT requests in Sheety.</p><p>Take a look at the Sheety API documentation to help you:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-07-30_11-49-46-f74d3a0356cf460dad55760dd428a8fa.png"></figure><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-07-30_11-57-58-6dd12ac194a4b85dcbaeba22e8b63e83.png"></figure><p>If successful, you should see the Google&nbsp;Sheet update as if by magic (but it's not magic, it's just code):</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/article_lecture/2021-02-01_12-08-23-a3e2a0e3a0047853a5ff9f27b4637355.gif"></figure><p>IMPORTANT: The Google Sheet URL that you put into Sheety must be owned by the same account as the Google account you used to sign into Sheety. </p></p></div></div></div></body></html>