<html><head><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/image.min.css"></head><body><div class="container"><div class="row"><div class="col-md-10 col-md-offset-1 ui image"><p class="lead"><p>In our bubble charts, we've seen how massively the industry has changed over time, especially from the 1970s onwards. This makes me think it makes sense to separate our films out by decade. Here's what I'm after:</p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-15_10-07-36-6a3655edec46115548a0f09bbd8b1173.png"></figure><h4>Challenge</h4><p>Can you create a column in <code>data_clean</code> that has the decade of the movie release. For example, a film released in 1992 or 1999 should have 1990 in the Decade column.</p><p>Here is one approach that you can follow:</p><ol><li><p>Create a <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DatetimeIndex.html" rel="noopener noreferrer" target="_blank"><code>DatetimeIndex</code> object</a> from the Release_Date column.</p></li></ol><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-16_10-59-13-2ca82264854d799c5ea7a9aac7246b85.png"></figure><ol><li><p>Grab all the years from the <code>DatetimeIndex</code> object using the <code>.year</code> property.</p></li><li><p>Use floor division <code>//</code> to convert the year data to the decades of the films.</p></li><li><p>Add the decades as a <code>Decade</code> column to the <code>data_clean</code> DataFrame.</p></li></ol><p><br></p><p>.</p><p>.</p><p>..</p><p>...</p><p>..</p><p>.</p><p>.</p><p><br></p><p><strong>Solution:&nbsp;Using Floor Division to Convert Years to Decades</strong></p><p>To create a DatetimeIndex, we just call the constructor and provide our release date column as an argument to initialise the DatetimeIndex object. Then we can extract all the years from the DatetimeIndex.</p><pre class="prettyprint linenums">dt_index = pd.DatetimeIndex(data_clean.Release_Date)<br>years = dt_index.year</pre><p>Now, all we need to do is convert the years to decades. For that, we will use floor division (aka integer division). The difference to regular division is that the result is effectively rounded down. </p><pre class="prettyprint linenums">5.0 / 2<br># output:&nbsp;2.5<br>5.0 // 2<br># output:&nbsp;2.0</pre><p>In our case, we will use the floor division by 10 and then multiplication by 10 to convert the release year to the release decade:</p><figure><img height="204" src="https://img-c.udemycdn.com/redactor/raw/2020-10-16_11-13-38-ea1ff36ff1f36d1b44616077685626e5.png" width="510"></figure><p>We can do this for all the years and then add the decades back as a column. </p><pre class="prettyprint linenums">decades = years//10*10<br>data_clean['Decade'] = decades</pre><p><br></p><h4>Challenge</h4><p>Create two new DataFrames: <code>old_films</code> and <code>new_films</code></p><ul><li><p><code>old_films</code> should include all the films before 1970 (up to and including 1969)</p></li><li><p><code>new_films</code> should include all the films from 1970 onwards</p></li><li><p>How many of our films were released prior to 1970?</p></li><li><p>What was the most expensive film made prior to 1970?</p></li></ul><p><br></p><p>.</p><p>.</p><p>..</p><p>...</p><p>..</p><p>.</p><p>.</p><p><br></p><p><strong>Solution:&nbsp;Separate the films made before and after 1970</strong></p><p>Now that we have our Decades column we can use it to create subsets of our data.</p><pre class="prettyprint linenums">old_films = data_clean[data_clean.Decade &lt;= 1960]<br>new_films = data_clean[data_clean.Decade &gt; 1960]</pre><p>The cut-off for our calculation is 1960 in the Decade column because this will still include 1969. When we inspect our old_films DataFrame we see that it only includes 153 films. As we saw in the bubble chart, the bulk of films in the dataset have been released in the last 30 years. </p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-16_11-29-47-b6944d0cec5baa62d332a7bcde19d8be.png"></figure><p>The most expensive film prior to 1970 was Cleopatra, with a production budget of $42 million. That's some serious 1960s money, and judging by the trailer, a lot of it went into extravagant costumes, set design, and plenty of extras. Impressive. </p><figure><img height="351" src="https://img-c.udemycdn.com/redactor/raw/2020-10-16_11-40-07-75393a74422b12f0ccc714e15e3eafbe.png" width="697"></figure></p></div></div></div></body></html>