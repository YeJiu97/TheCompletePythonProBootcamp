<html><head><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/image.min.css"></head><body><div class="container"><div class="row"><div class="col-md-10 col-md-offset-1 ui image"><p class="lead"><p>Given our database consists of a bunch of cafes to remote-work from, one of the likely use cases of our API is a developer who wants to serve up a random cafe for their user to go to. So let's create a /random route that serves up a random cafe.</p><p>1. Create a <code>/random</code> route in main.py that allows GET requests to be made to it. </p><p><a href="https://gist.github.com/angelabauer/f5509db5a9581c49fc532c3e94f433e2" rel="noopener noreferrer" target="_blank">SOLUTION</a></p><p><br></p><p>2. When someone makes a <code>GET</code>&nbsp;request to the <code>/random</code> route, our Flask server should fetch a random cafe from our database.</p><p>NOTE: Don't worry about returning anything at the moment.</p><p><a href="https://gist.github.com/angelabauer/296c938b2f6a48a0b7fb34cf18d28c70" rel="noopener noreferrer" target="_blank">SOLUTION</a></p><p><br></p><p>Normally, we've been returning HTML templates using render_template(), but this time, because our server is now acting as an API, we want to return a JSON containing the necessary data. Just like real public APIs.</p><p>e.g. ISS API: <a href="http://api.open-notify.org/iss-now.json" rel="noopener noreferrer" target="_blank">http://api.open-notify.org/iss-now.json</a></p><p><br></p><p>In order to do this, we have to turn our random_cafe SQLAlchemy <strong>Object</strong> into a <strong>JSON</strong>. This process is called <strong>serialization</strong>. </p><p>Flask has a serialisation helper method built-in called <code>jsonify()</code> . But we have to provide the structure of the JSON to return. </p><p><br></p><p>3. See if you can use <a href="https://www.kite.com/python/docs/flask.jsonify" rel="noopener noreferrer" target="_blank">the documentation on jsonify()</a> to figure out how to get the <code>/random</code> route to work. If successful, this is what you should see when you run main.py and go to <strong>localhost:5000/random</strong></p><figure><img src="https://img-c.udemycdn.com/redactor/raw/2020-10-08_10-24-59-f5549c994f213c6763a941e37077026c.png"></figure><p><a href="https://gist.github.com/angelabauer/776be425f5a442f4cc5b780e083fbe8c" rel="noopener noreferrer" target="_blank">SOLUTION</a></p><p>The method described in the docs has maximum flexibility. It allows you to have perfect control over the JSON response. e.g. You could also structure the response by omitting some properties like <code>id</code>. You could also group the Boolean properties into a subsection called amenities.</p><p><a href="https://gist.github.com/angelabauer/e8542ae3ffae75584f6f4771b95c5436" rel="noopener noreferrer" target="_blank">e.g. CODE</a></p><p><br></p><p>But in most cases, you might just want to return all the data you have on a particular record and it would drive you crazy if you had to write out all that code for every route. </p><p>So another method of serialising our database row Object to JSON is by first converting it to a dictionary and then using jsonify() to convert the dictionary (which is very similar in structure to JSON) to a JSON. </p><p><a href="https://gist.github.com/angelabauer/ce2f38fae6fd84b854296d7d4303cec0" rel="noopener noreferrer" target="_blank">CODE</a></p></p></div></div></div></body></html>